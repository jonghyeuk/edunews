<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì…ì‹œë‰´ìŠ¤ - ì£¼ê°„ êµìœ¡ì²­ ì†Œì‹</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics-compat.js"></script>
    
    <!-- PWA ì„¤ì • -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#2a5298">
    
    <style>
        /* ì…ì‹œë‰´ìŠ¤ ì›¹ì‚¬ì´íŠ¸ ìŠ¤íƒ€ì¼ë§ */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&family=Noto+Serif+KR:wght@400;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }
        
        /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            font-size: 1.2em;
            color: #666;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2a5298;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* í—¤ë” */
        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .masthead {
            font-family: 'Noto Serif KR', serif;
            font-size: 2.5em;
            font-weight: 700;
            text-align: center;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .tagline {
            text-align: center;
            font-size: 1.1em;
            opacity: 0.9;
            margin-bottom: 15px;
        }
        
        .date-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9em;
            border-top: 1px solid rgba(255,255,255,0.3);
            padding-top: 15px;
        }
        
        .update-time {
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8em;
        }
        
        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .main-container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 30px;
        }
        
        /* ë©”ì¸ ì½˜í…ì¸  */
        .main-content {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        /* ê¸°ì‚¬ ìŠ¤íƒ€ì¼ */
        .article {
            padding: 30px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .article:last-child {
            border-bottom: none;
        }
        
        .article.featured {
            background: linear-gradient(135deg, #fff5f5 0%, #fff 100%);
            border-left: 4px solid #dc3545;
        }
        
        .headline {
            font-family: 'Noto Serif KR', serif;
            font-size: 1.8em;
            font-weight: 700;
            margin-bottom: 10px;
            color: #1e3c72;
            line-height: 1.3;
        }
        
        .subheading {
            font-family: 'Noto Serif KR', serif;
            font-size: 1.4em;
            font-weight: 600;
            margin-bottom: 10px;
            color: #2a5298;
        }
        
        .meta-info {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            font-size: 0.9em;
            color: #6c757d;
        }
        
        .source-tag {
            background: #e7f3ff;
            color: #0056b3;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 500;
        }
        
        .urgent-tag {
            background: #fff3cd;
            color: #856404;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 500;
        }
        
        .article-text {
            font-size: 1em;
            line-height: 1.7;
            margin-bottom: 15px;
        }
        
        /* ì„¹ì…˜ í—¤ë” */
        .section-header {
            background: linear-gradient(135deg, #2a5298 0%, #1e3c72 100%);
            color: white;
            padding: 15px 30px;
            font-family: 'Noto Serif KR', serif;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        /* ë‹¤ì¤‘ ì»¬ëŸ¼ ë ˆì´ì•„ì›ƒ */
        .multi-column {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding: 30px;
        }
        
        .column-article {
            padding: 20px;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            background: #fafafa;
        }
        
        /* ì‚¬ì´ë“œë°” */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        /* ê´‘ê³  ì˜ì—­ */
        .ad-space {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            height: 250px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .ad-space:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .ad-space.large {
            height: 600px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .ad-content {
            z-index: 2;
            position: relative;
        }
        
        .ad-title {
            font-size: 1.2em;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .ad-subtitle {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 12px;
        }
        
        .ad-features {
            font-size: 0.8em;
            opacity: 0.8;
            line-height: 1.4;
        }
        
        .science-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        /* ë¹ ë¥¸ ì •ë³´ ë°•ìŠ¤ */
        .quick-info {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
        }
        
        .quick-info h3 {
            color: #2a5298;
            margin-bottom: 15px;
            font-size: 1.2em;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 8px;
        }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .main-container {
                grid-template-columns: 1fr;
                margin: 20px auto;
                padding: 0 15px;
            }
            
            .multi-column {
                grid-template-columns: 1fr;
                padding: 20px;
            }
            
            .masthead {
                font-size: 2em;
            }
            
            .headline {
                font-size: 1.5em;
            }
            
            .article {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h1 class="masthead">ğŸ“ ì…ì‹œë‰´ìŠ¤</h1>
            <p class="tagline">ì „êµ­ êµìœ¡ì²­ ì…ì‹œì •ë³´ í•œëˆˆì— ë³´ê¸°</p>
            <div class="date-info">
                <span id="current-week">ì£¼ê°„ì†Œì‹ ë¡œë”©ì¤‘...</span>
                <span class="update-time">â° ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸</span>
            </div>
        </div>
    </header>

    <div class="main-container">
        <main class="main-content">
            <!-- ë¡œë”© í‘œì‹œ -->
            <div id="loading" class="loading">
                <div class="spinner"></div>
                ìµœì‹  ì…ì‹œë‰´ìŠ¤ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
            </div>
            
            <!-- ë‰´ìŠ¤ ì»¨í…ì¸  (ë™ì ìœ¼ë¡œ ë¡œë“œ) -->
            <div id="news-content" style="display: none;">
                <!-- Firebaseì—ì„œ ë¡œë“œëœ ë‰´ìŠ¤ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
        </main>

        <aside class="sidebar">
            <!-- Little Science AI ê´‘ê³  -->
            <div class="ad-space" onclick="window.open('https://www.littlescienceai.com', '_blank')">
                <div class="ad-content">
                    <div class="science-icon">ğŸ”¬</div>
                    <div class="ad-title">ê³¼í•™ì†Œë…¼ë¬¸ ì£¼ì œì„ ì •</div>
                    <div class="ad-subtitle">AIê°€ ì¶”ì²œí•˜ëŠ” ë§ì¶¤í˜• ì—°êµ¬ì£¼ì œ</div>
                    <div class="ad-features">ìƒê¸°ë¶€ ì™„ì„± â€¢ ì§„ë¡œ ì—°ê³„ â€¢ ì „ë¬¸ê°€ ê²€ì¦</div>
                </div>
            </div>

            <!-- êµ¬ë… ì„œë¹„ìŠ¤ -->
            <div class="ad-space" style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);" onclick="subscribeNewsletter()">
                <div class="ad-content">
                    <div class="science-icon">ğŸ“§</div>
                    <div class="ad-title">ì…ì‹œë‰´ìŠ¤ ë¬´ë£Œêµ¬ë…</div>
                    <div class="ad-subtitle">ë§¤ì£¼ ì›”ìš”ì¼ ì•„ì¹¨ 8ì‹œ ì •í™• ë°°ì†¡</div>
                    <div class="ad-features">ì´ë©”ì¼ â€¢ ë¬¸ì â€¢ ì¹´ì¹´ì˜¤í†¡ ì•Œë¦¼</div>
                </div>
            </div>

            <!-- ì„¸ì¢…ê³¼í•™êµì‹¤ ê´‘ê³  -->
            <div class="ad-space large" onclick="window.open('http://sejongclass.co.kr', '_blank')">
                <div class="ad-content">
                    <div class="science-icon">ğŸ”¬</div>
                    <div class="ad-title">ì„¸ì¢…ê³¼í•™êµì‹¤</div>
                    <div class="ad-subtitle">í•™êµë¡œ ì°¾ì•„ê°€ëŠ” ì‹¤í—˜ìˆ˜ì—…</div>
                    <div class="ad-features">
                        ğŸ§ª ë°•ì‚¬ê¸‰ ì „ë¬¸ ê°•ì‚¬ì§„<br>
                        ğŸ¯ ì§„ë¡œì—°ê³„ ì‹¤í—˜ í”„ë¡œê·¸ë¨<br>
                        ğŸ« í•™êµ ì§ì ‘ ë°©ë¬¸ ìˆ˜ì—…<br>
                        ğŸ“š í•™ìƒë¶€ì¢…í•©ì „í˜• ëŒ€ë¹„<br><br>
                        <strong>ì´ê³µê³„ ê¿ˆë‚˜ë¬´ë“¤ì„ ìœ„í•œ íŠ¹ë³„í•œ ê²½í—˜!</strong>
                    </div>
                </div>
            </div>
        </aside>
    </div>

    <!-- Firebase ì´ˆê¸°í™” ë° ì•± ë¡œì§ -->
    <script>
        // Firebase ì„¤ì • (ì‹¤ì œ configë¡œ êµì²´ í•„ìš”)
        const firebaseConfig = {
            // Firebase í”„ë¡œì íŠ¸ ì„¤ì •ê°’ìœ¼ë¡œ êµì²´
            apiKey: "your-api-key",
            authDomain: "education-news-site.firebaseapp.com",
            projectId: "education-news-site",
            storageBucket: "education-news-site.appspot.com",
            messagingSenderId: "123456789",
            appId: "your-app-id"
        };

        // Firebase ì´ˆê¸°í™”
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        
        // Analytics ì´ˆê¸°í™”
        firebase.analytics();

        // ë‰´ìŠ¤ ë°ì´í„° ë¡œë“œ
        async function loadNews() {
            try {
                // Firestoreì—ì„œ ìµœì‹  ë‰´ìŠ¤ ê°€ì ¸ì˜¤ê¸°
                const newsSnapshot = await db.collection('news')
                    .orderBy('created_at', 'desc')
                    .limit(10)
                    .get();

                if (newsSnapshot.empty) {
                    // ë‰´ìŠ¤ê°€ ì—†ìœ¼ë©´ ìƒ˜í”Œ ë‰´ìŠ¤ í‘œì‹œ
                    showSampleNews();
                    return;
                }

                const articles = [];
                newsSnapshot.forEach(doc => {
                    articles.push(doc.data());
                });

                displayNews(articles);
            } catch (error) {
                console.error('ë‰´ìŠ¤ ë¡œë”© ì˜¤ë¥˜:', error);
                showSampleNews();
            }
        }

        // ë‰´ìŠ¤ í‘œì‹œ
        function displayNews(articles) {
            const newsContent = document.getElementById('news-content');
            const loading = document.getElementById('loading');
            
            let html = '';
            
            // ì£¼ìš” ë‰´ìŠ¤ (ì²« ë²ˆì§¸ ê¸°ì‚¬)
            if (articles[0]) {
                html += `
                    <article class="article featured">
                        <h2 class="headline">${articles[0].title}</h2>
                        <div class="meta-info">
                            <span class="meta-item">ğŸ“ ${articles[0].source}</span>
                            <span class="meta-item">ğŸ“… ${formatDate(articles[0].created_at)}</span>
                            <span class="source-tag">${articles[0].source}</span>
                            <span class="urgent-tag">ìµœì‹ </span>
                        </div>
                        <p class="article-text">${articles[0].summary || articles[0].content}</p>
                    </article>
                `;
            }
            
            // êµìœ¡ì²­ ì„¹ì…˜
            const educationOfficeNews = articles.filter(article => 
                article.category === 'education_office' || article.source.includes('êµìœ¡ì²­')
            ).slice(0, 4);
            
            if (educationOfficeNews.length > 0) {
                html += `
                    <section>
                        <div class="section-header">ğŸ›ï¸ ì‹œë„êµìœ¡ì²­ ì£¼ìš” ê³µì§€ì‚¬í•­</div>
                        <div class="multi-column">
                `;
                
                educationOfficeNews.forEach(article => {
                    html += `
                        <article class="column-article">
                            <h3 class="subheading">${article.source}</h3>
                            <div class="meta-info">
                                <span class="source-tag">${article.source}</span>
                                <span class="meta-item">ğŸ“… ${formatDate(article.created_at)}</span>
                            </div>
                            <p class="article-text">${article.summary || article.content}</p>
                        </article>
                    `;
                });
                
                html += `
                        </div>
                    </section>
                `;
            }
            
            newsContent.innerHTML = html;
            
            // ë¡œë”© ìˆ¨ê¸°ê³  ì»¨í…ì¸  í‘œì‹œ
            loading.style.display = 'none';
            newsContent.style.display = 'block';
            
            // í˜„ì¬ ë‚ ì§œ ì—…ë°ì´íŠ¸
            updateCurrentDate();
        }

        // ìƒ˜í”Œ ë‰´ìŠ¤ í‘œì‹œ (Firestoreì— ë°ì´í„°ê°€ ì—†ì„ ë•Œ)
        function showSampleNews() {
            const newsContent = document.getElementById('news-content');
            const loading = document.getElementById('loading');
            
            newsContent.innerHTML = `
                <article class="article featured">
                    <h2 class="headline">Firebase ì…ì‹œë‰´ìŠ¤ ì‚¬ì´íŠ¸ê°€ ì •ìƒì ìœ¼ë¡œ ë°°í¬ë˜ì—ˆìŠµë‹ˆë‹¤!</h2>
                    <div class="meta-info">
                        <span class="meta-item">ğŸ“ ì‹œìŠ¤í…œ</span>
                        <span class="meta-item">ğŸ“… ${new Date().toLocaleDateString()}</span>
                        <span class="source-tag">ì‹œìŠ¤í…œ ì•Œë¦¼</span>
                        <span class="urgent-tag">í™•ì¸</span>
                    </div>
                    <p class="article-text">
                        ì¶•í•˜í•©ë‹ˆë‹¤! Firebase ê¸°ë°˜ ì…ì‹œë‰´ìŠ¤ ì‚¬ì´íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ë°°í¬ë˜ì—ˆìŠµë‹ˆë‹¤. 
                        í¬ë¡¤ë§ ì‹œìŠ¤í…œì´ í™œì„±í™”ë˜ë©´ ì‹¤ì œ êµìœ¡ì²­ ë‰´ìŠ¤ê°€ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.
                    </p>
                </article>
                
                <section>
                    <div class="section-header">ğŸš€ ë‹¤ìŒ ë‹¨ê³„</div>
                    <div class="multi-column">
                        <article class="column-article">
                            <h3 class="subheading">í¬ë¡¤ë§ ì‹œìŠ¤í…œ í™œì„±í™”</h3>
                            <p class="article-text">Cloud Functionsë¥¼ ë°°í¬í•˜ì—¬ êµìœ¡ì²­ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ìë™ìœ¼ë¡œ ë‰´ìŠ¤ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤.</p>
                        </article>
                        <article class="column-article">
                            <h3 class="subheading">ìŠ¤ì¼€ì¤„ë§ ì„¤ì •</h3>
                            <p class="article-text">ë§¤ì£¼ ì›”ìš”ì¼ ì˜¤ì „ 8ì‹œì— ìë™ìœ¼ë¡œ ìµœì‹  ë‰´ìŠ¤ë¥¼ ì—…ë°ì´íŠ¸í•˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.</p>
                        </article>
                    </div>
                </section>
            `;
            
            loading.style.display = 'none';
            newsContent.style.display = 'block';
            updateCurrentDate();
        }

        // ë‚ ì§œ í¬ë§·íŒ…
        function formatDate(timestamp) {
            if (!timestamp) return new Date().toLocaleDateString();
            
            let date;
            if (timestamp.toDate) {
                date = timestamp.toDate();
            } else {
                date = new Date(timestamp);
            }
            
            return date.toLocaleDateString('ko-KR');
        }

        // í˜„ì¬ ë‚ ì§œ ì—…ë°ì´íŠ¸
        function updateCurrentDate() {
            const now = new Date();
            const weekStart = new Date(now.setDate(now.getDate() - now.getDay() + 1));
            const weekEnd = new Date(now.setDate(now.getDate() - now.getDay() + 7));
            
            const formatWeek = (date) => {
                return `${date.getMonth() + 1}ì›” ${date.getDate()}ì¼`;
            };
            
            document.getElementById('current-week').textContent = 
                `${formatWeek(weekStart)} ~ ${formatWeek(weekEnd)} ì£¼ê°„ì†Œì‹`;
        }

        // êµ¬ë… ì‹ ì²­ (ê°„ë‹¨í•œ ë²„ì „)
        function subscribeNewsletter() {
            const email = prompt('ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”:');
            if (email) {
                // Firestoreì— êµ¬ë…ì ì •ë³´ ì €ì¥
                db.collection('subscribers').add({
                    email: email,
                    subscribed_at: firebase.firestore.FieldValue.serverTimestamp(),
                    active: true
                }).then(() => {
                    alert('êµ¬ë… ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ“§');
                }).catch(error => {
                    console.error('êµ¬ë… ì‹ ì²­ ì˜¤ë¥˜:', error);
                    alert('êµ¬ë… ì‹ ì²­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                });
            }
        }

        // ì‹¤ì‹œê°„ ë‰´ìŠ¤ ì—…ë°ì´íŠ¸ ê°ì§€
        function setupRealtimeUpdates() {
            db.collection('news')
                .orderBy('created_at', 'desc')
                .limit(1)
                .onSnapshot(snapshot => {
                    snapshot.docChanges().forEach(change => {
                        if (change.type === 'added') {
                            // ìƒˆ ë‰´ìŠ¤ê°€ ì¶”ê°€ë˜ë©´ ì•Œë¦¼
                            showNewNewsNotification();
                        }
                    });
                });
        }

        // ìƒˆ ë‰´ìŠ¤ ì•Œë¦¼
        function showNewNewsNotification() {
            // ê°„ë‹¨í•œ ì•Œë¦¼ (ì‹¤ì œë¡œëŠ” ë” ì˜ˆìœ ì•Œë¦¼ êµ¬í˜„)
            if (Notification.permission === 'granted') {
                new Notification('ğŸ“° ìƒˆë¡œìš´ ì…ì‹œë‰´ìŠ¤ê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤!', {
                    icon: '/icon-192x192.png',
                    badge: '/icon-192x192.png'
                });
            }
        }

        // ì•Œë¦¼ ê¶Œí•œ ìš”ì²­
        function requestNotificationPermission() {
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', function() {
            loadNews();
            setupRealtimeUpdates();
            requestNotificationPermission();
            
            // í˜ì´ì§€ ì¡°íšŒ ì´ë²¤íŠ¸ ê¸°ë¡
            firebase.analytics().logEvent('page_view', {
                page_title: 'ì…ì‹œë‰´ìŠ¤ ë©”ì¸í˜ì´ì§€',
                page_location: window.location.href
            });
        });
    </script>
</body>
</html>
